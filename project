CREATE TABLE  Customers (
    CustomerID INT PRIMARY KEY,
    FirstName VARCHAR(50),
    LastName VARCHAR(50),
    Email VARCHAR(100),
    RegistrationDate DATE
);

INSERT INTO Customers (CustomerID, FirstName, LastName, Email, RegistrationDate) VALUES
(1, 'John', 'Doe', 'john.doe@email.com', '2022-03-15'),
(2, 'Robert', 'Brown', 'robert.brown@email.com', '2023-06-10'),
(3, 'Michael', 'Wilson', 'michael.wilson@email.com', '2022-08-05');

CREATE TABLE  Orders (
    OrderID INT PRIMARY KEY,
    CustomerID INT,    
    OrderDate DATE,
    TotalAmount DECIMAL(10,2)
);

INSERT INTO Orders (OrderID, CustomerID, OrderDate, TotalAmount) VALUES
(101, 1, '2023-07-01', 150.50),
(102, 2, '2023-07-03', 200.75),
(103, 1, '2023-09-01', 99.99),
(104, 4, '2023-09-20', 450.25);


CREATE TABLE  Employees (
    EmployeeID INT PRIMARY KEY,
    FirstName VARCHAR(50),
    LastName VARCHAR(50),
    Department VARCHAR(50),
    HireDate DATE,
    Salary DECIMAL(10,2)
);


INSERT INTO Employees (EmployeeID, FirstName, LastName, Department, HireDate, Salary) VALUES
(1, 'Mark', 'Johnson', 'Sales', '2020-01-15', 50000.00),
(2, 'Susan', 'Lee', 'HR', '2021-03-20', 55000.00),
(3, 'David', 'Miller', 'IT', '2022-05-10', 60000.00),
(4, 'Anna', 'Taylor', 'Finance', '2019-11-05', 70000.00),

1.
SELECT * FROM `orders` INNER JOIN customers on orders.CustomerID=customers.CustomerID

2.
SELECT * FROM `customers` LEFT JOIN orders on customers.CustomerID=orders.CustomerID

3.
SELECT * FROM `customers` RIGHT JOIN orders ON orders.CustomerID=customers.CustomerID

4.
SELECT * FROM Customers c LEFT JOIN Orders o ON c.CustomerID = o.CustomerID 
UNION SELECT * FROM Customers c RIGHT JOIN Orders o ON c.CustomerID = o.CustomerID;

5.
SELECT c.CustomerID, c.FirstName, c.LastName, SUM(o.TotalAmount) AS TotalSpent
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
GROUP BY c.CustomerID, c.FirstName, c.LastName
HAVING SUM(o.TotalAmount) > (SELECT AVG(TotalAmount) FROM Orders)

6.
SELECT employees.firstname,LastName FROM `employees` WHERE Salary>(SELECT AVG(Salary) FROM employees)

7.
SELECT YEAR(OrderDate) AS OrderYear, MONTH(OrderDate) AS OrderMonth FROM Orders

8.
SELECT datediff(CURRENT_DATE(),OrderDate) AS datediffrent FROM orders;

9.
SELECT  DATE_FORMAT(OrderDate, '%d-%b-%Y') AS FormattedDate FROM Orders;

Ans-10
SELECT CustomerID, CONCAT(FirstName, ' ', LastName) AS FullName FROM Customers;

Ans-11
SELECT CustomerID, REPLACE(FirstName, 'John', 'Jonathan') AS ModifyName FROM Customers;

Ans-12
SELECT UPPER(FirstName) AS FirstNameUpper, LOWER(LastName) AS LastNameLower FROM Customers;

Ans-13
SELECT TRIM(Email) AS CleanEmail FROM Customers;

Ans-14
SELECT *,SUM(TotalAmount) OVER (ORDER BY OrderDate) AS RunningTotal FROM Orders;

Ans-15
SELECT *,RANK() OVER (ORDER BY TotalAmount DESC) AS OrderRank FROM Orders;

Ans-16
SELECT *,
CASE 
           WHEN TotalAmount > 1000 THEN '10% Discount'
           WHEN TotalAmount > 500 THEN '5% Discount'
           ELSE 'No Discount'
       END AS Discount
FROM Orders;






